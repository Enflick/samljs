<samlp:Response xmlns:samlp="urn:oasis:names:tc:SAML:2.0:protocol" ID="<%=responseId%>" InResponseTo="<%=spAssertionId%>" Version="2.0" IssueInstant="<%=timestamp%>" Destination="<%=acsUrl%>">
	<saml:Issuer xmlns:saml="urn:oasis:names:tc:SAML:2.0:assertion"><%=issuer%></saml:Issuer>
	<samlp:Status xmlns:samlp="urn:oasis:names:tc:SAML:2.0:protocol">
		<samlp:StatusCode xmlns:samlp="urn:oasis:names:tc:SAML:2.0:protocol" Value="urn:oasis:names:tc:SAML:2.0:status:Success"></samlp:StatusCode>
	</samlp:Status>
	<saml:Assertion xmlns:saml="urn:oasis:names:tc:SAML:2.0:assertion" ID="<%=assertionId%>" IssueInstant="<%=timestamp%>" Version="2.0">
		<saml:Issuer><%=issuer%></saml:Issuer>
		<ds:Signature xmlns:ds="http://www.w3.org/2000/09/xmldsig#">
			<ds:SignedInfo>
				<ds:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
				<ds:SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#rsa-sha1"/>
				<ds:Reference URI="#s2af6627280d72f061beb9f8b1635bd54cc2892317">
					<ds:Transforms>
						<ds:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
						<ds:Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
					</ds:Transforms>
					<ds:DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"/>
					<ds:DigestValue><%=digestValue%></ds:DigestValue>
				</ds:Reference>
			</ds:SignedInfo>
			<ds:SignatureValue>
				<%=signature%>
			</ds:SignatureValue>
			<ds:KeyInfo>
				<ds:X509Data>
					<ds:X509Certificate>
						<%=cert%>
					</ds:X509Certificate>
				</ds:X509Data>
			</ds:KeyInfo>
		</ds:Signature>
		<saml:Subject>
			<saml:NameID Format="urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress" NameQualifier="<%=nameQualifier%>"><%=email%></saml:NameID>
			<saml:SubjectConfirmation Method="urn:oasis:names:tc:SAML:2.0:cm:bearer">
				<saml:SubjectConfirmationData InResponseTo="<%=spAssertionId%>" NotOnOrAfter="<%=notOnOrAfter%>" Recipient="<%=acsUrl%>"/></saml:SubjectConfirmation>
		</saml:Subject>
		<% if (conditions) { %>
		<saml:Conditions NotBefore="<%=conditions.notBefore%>" NotOnOrAfter="<%=conditions.notOnOrAfter%>">
			<saml:AudienceRestriction>
				<saml:Audience><%=conditions.audience%></saml:Audience>
			</saml:AudienceRestriction>
		</saml:Conditions>
		<% } %>
		<saml:AuthnStatement AuthnInstant="<%=timestamp%>" SessionIndex="<%=sessIndex%>">
			<saml:AuthnContext>
				<saml:AuthnContextClassRef>urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport</saml:AuthnContextClassRef>
			</saml:AuthnContext>
		</saml:AuthnStatement>
	</saml:Assertion>
</samlp:Response>
